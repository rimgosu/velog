<h1 id="azure-gpu-âœ…">azure gpu âœ…</h1>
<ul>
<li>colab í”„ë¡œ ê²°ì œí•´ë„ í™˜ê²½ êµ¬ì¶•í•˜ê¸°ì— í•œê³„ê°€ ìˆë‹¤</li>
</ul>
<p><img alt="" src="https://velog.velcdn.com/images/rimgosu/post/ed81c1be-7c6c-49c9-84a9-fb1957344c5b/image.png" /></p>
<p><img alt="" src="https://velog.velcdn.com/images/rimgosu/post/97828f1f-6320-4c95-ae1a-0f1affef804b/image.png" /></p>
<ul>
<li>ë°ì´í„° ë„£ìœ¼ë©´ <strong>ë°ì´í„° ì „ì²˜ë¦¬ ì•Œì•„ì„œ í•´ì¤Œ</strong> <em>(AutoML)</em></li>
<li>í•™ìŠµ ì‹œí‚¤ë©´ <strong>í•˜ì´í¼ íŒŒë¼ë¯¸í„° íŠœë‹ ì•Œì•„ì„œ í•´ì¤Œ</strong> <em>(AutoML)</em></li>
</ul>
<h2 id="azure-machine-learning-studio">Azure Machine Learning Studio</h2>
<p><img alt="" src="https://velog.velcdn.com/images/rimgosu/post/134008a0-1191-436a-92b6-88b3b097ddfb/image.png" /></p>
<ul>
<li><strong>studio ì‹œì‘í•˜ê¸°</strong></li>
</ul>
<h3 id="titanic-ë¶„ë¥˜">titanic ë¶„ë¥˜</h3>
<ul>
<li>titanic.csv ë‹¤ìš´ë¡œë“œ : <a href="https://github.com/datasciencedojo/datasets/blob/master/titanic.csv">https://github.com/datasciencedojo/datasets/blob/master/titanic.csv</a></li>
</ul>
<h3 id="ë°ì´í„°-ì„¸íŠ¸-ë§Œë“¤ê¸°">ë°ì´í„° ì„¸íŠ¸ ë§Œë“¤ê¸°</h3>
<ul>
<li>url_file vs ë°ì´í„° ì„¸íŠ¸(í‘œ)</li>
</ul>
<h4 id="ìì‚°---ë°ì´í„°---ë§Œë“¤ê¸°---url_file">ìì‚° - ë°ì´í„° - ë§Œë“¤ê¸° - url_file</h4>
<p><img alt="" src="https://velog.velcdn.com/images/rimgosu/post/704eb31d-0121-4c57-9ab9-a367938f5d58/image.png" /></p>
<p><img alt="" src="https://velog.velcdn.com/images/rimgosu/post/0d17777f-aacd-4442-a7d3-e74b2e585c24/image.png" /></p>
<h4 id="ìì‚°---ë°ì´í„°---ë§Œë“¤ê¸°---í‘œ-í˜•ì‹">ìì‚° - ë°ì´í„° - ë§Œë“¤ê¸° - í‘œ í˜•ì‹</h4>
<p><img alt="" src="https://velog.velcdn.com/images/rimgosu/post/0fd7e70e-cb2c-4233-8247-24834dcd03fc/image.png" /></p>
<p><img alt="" src="https://velog.velcdn.com/images/rimgosu/post/dc991973-b400-4c99-8340-29e69f4879ee/image.png" /></p>
<p><img alt="" src="https://velog.velcdn.com/images/rimgosu/post/bd90bb40-6597-41f6-90f1-b819e178d4ec/image.png" /></p>
<p><img alt="" src="https://velog.velcdn.com/images/rimgosu/post/c4e0c01f-ba74-4c25-bc4b-069bbfd13221/image.png" /></p>
<p><img alt="" src="https://velog.velcdn.com/images/rimgosu/post/eee5fc4e-05a9-4295-9139-d684043af438/image.png" /></p>
<ul>
<li>dbì—ì„œ ëŒì–´ì˜¬ ìˆ˜ ìˆëŠ”ë“¯</li>
<li>ë°ì´í„° ì„¸íŠ¸ë¡œ ë§Œë“œëŠ” ê²ƒì´ ë‹¤ìŒê³¼ ê°™ì´ ì„¤ì •ë„ ê°€ëŠ¥í•˜ê³  ë” í¸í•˜ê²Œ ì“¸ ìˆ˜ ìˆë‹¤.</li>
<li>ì‰½ê²Œ í•„ìš”í•œ ì»¬ëŸ¼ë§Œ ê°€ì ¸ì™€ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</li>
</ul>
<h3 id="ë””ìì´ë„ˆ-âœ…">ë””ìì´ë„ˆ âœ…</h3>
<p><img alt="" src="https://velog.velcdn.com/images/rimgosu/post/c5f85079-ec09-4803-9a23-815272f2ee40/image.png" /></p>
<ul>
<li>ë‹¤ë¥¸ì‚¬ëŒì´ í•œ ëª¨ë¸ë“¤ ë¶ˆëŸ¬ì™€ì„œ ì‚¬ìš© ê°€ëŠ¥í•˜ë‹¤</li>
<li>ìƒˆë¡œ ë§Œë“¤ê¸° (+) ë²„íŠ¼ í´ë¦­</li>
</ul>
<p><img alt="" src="https://velog.velcdn.com/images/rimgosu/post/350af4f3-5752-4286-b460-4c4ba9ce20e8/image.png" /></p>
<p><img alt="" src="https://velog.velcdn.com/images/rimgosu/post/39bb9b04-ee3b-4995-a98d-0f4cf56c9ece/image.png" /></p>
<h4 id="machine-learning-algorithm-cheat-sheet">Machine Learning Algorithm Cheat Sheet</h4>
<ul>
<li>ë¨¸ê¸€ì„ ìœ„í•œ ë¨¸ì‹ ëŸ¬ë‹ ë°©ë²• ì°¾ê¸°
<img alt="" src="https://velog.velcdn.com/images/rimgosu/post/2b71078b-5c69-41bb-9acf-e9f438623dd0/image.png" /></li>
</ul>
<h4 id="ë””ìì´ë„ˆë¥¼-ì ë‹¹íˆ-ì¡°í•©í•˜ì—¬-ë‹¤ìŒê³¼-ê°™ì€-ëª¨ë¸ì„-ë§Œë“¤ì—ˆë‹¤">ë””ìì´ë„ˆë¥¼ ì ë‹¹íˆ ì¡°í•©í•˜ì—¬ ë‹¤ìŒê³¼ ê°™ì€ ëª¨ë¸ì„ ë§Œë“¤ì—ˆë‹¤.</h4>
<p><img alt="" src="https://velog.velcdn.com/images/rimgosu/post/276e41af-f848-4c5b-91ea-371bccba3b68/image.png" /></p>
<h3 id="ì»´í“¨íŒ…">ì»´í“¨íŒ…</h3>
<p><img alt="" src="https://velog.velcdn.com/images/rimgosu/post/ed8da38b-6d91-41ef-822b-577cd022c9b0/image.png" /></p>
<ul>
<li>ìƒˆë¡œ ë§Œë“¤ê¸° í´ë¦­</li>
</ul>
<p><img alt="" src="https://velog.velcdn.com/images/rimgosu/post/594ccf44-4bd1-4da3-8ea1-adfa178aa558/image.png" /></p>
<ul>
<li>gpuë¡œ ì„ íƒí•˜ë ¤ë©´ ? ë²„íŠ¼ìœ¼ë¡œ ì´ë©”ì¼ ë³´ë‚´ì„œ gpu í• ë‹¹í•´ë‹¬ë¼ê³  ë©”ì¼ ë³´ë‚´ì•¼í•¨</li>
</ul>
<p><img alt="" src="https://velog.velcdn.com/images/rimgosu/post/e81e6b3c-d313-4795-9c84-82b4663ef5db/image.png" /></p>
<p><img alt="" src="https://velog.velcdn.com/images/rimgosu/post/3affc3e5-ca4d-450a-bd7f-8fc799829f3f/image.png" /></p>
<ul>
<li>ë‹¤ì‹œ ë””ìì´ë„ˆë¡œ ëŒì•„ì™€ì„œ êµ¬ì„± ë° ì œì¶œí•˜ë©´ ëœë‹¤.</li>
</ul>
<p><img alt="" src="https://velog.velcdn.com/images/rimgosu/post/787afe00-a45c-4c70-a860-7a2fd42379af/image.png" /></p>
<h3 id="ì‘ì—…">ì‘ì—…</h3>
<ul>
<li>ì œì¶œí•˜ë©´ ë‹¤ìŒê³¼ ê°™ì´ ë¨¸ì‹ ëŸ¬ë‹ í•˜ëŠ” ê²ƒì„ ì‹œê°ì ìœ¼ë¡œ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</li>
</ul>
<p><img alt="" src="https://velog.velcdn.com/images/rimgosu/post/e4eac9bc-f517-4c30-a0bb-a9054a6c50dd/image.png" /></p>
<ul>
<li>ë°ì´í„° ë¯¸ë¦¬ë³´ê¸°ë¡œ í‰ê°€ ì§€í‘œ ì‹œê°í™” ê°€ëŠ¥</li>
</ul>
<p><img alt="" src="https://velog.velcdn.com/images/rimgosu/post/18bfe76a-bae8-46db-9c64-ac2e062cd21a/image.png" /></p>
<p><img alt="" src="https://velog.velcdn.com/images/rimgosu/post/4d1b6c50-04d2-4f3c-8f08-840845026dc2/image.png" /></p>
<p><img alt="" src="https://velog.velcdn.com/images/rimgosu/post/2050e786-c1ea-46e8-ad68-5d31aecf5586/image.png" /></p>
<h3 id="ìë™í™”ëœ-ml-ğŸ‘âœ…">ìë™í™”ëœ ML ğŸ‘âœ…</h3>
<ul>
<li>AutoML</li>
<li>ë‘êº¼ìš´ ë²•ì¸ì¹´ë“œë§Œ ìˆìœ¼ë©´ ì§±ì´ë‹¤</li>
</ul>
<p><img alt="" src="https://velog.velcdn.com/images/rimgosu/post/cdeb395f-1b86-4ffc-8630-4b7f9eb147dc/image.png" /></p>
<ul>
<li><p>ë¶„ë¥˜, íšŒê·€, ì‹œê³„ì—´ ì˜ˆì¸¡, ìì—°ì–´ ì²˜ë¦¬, cv ê°€ëŠ¥í•˜ë‹¤
<img alt="" src="https://velog.velcdn.com/images/rimgosu/post/def626a5-76e3-491a-8877-b57e054d8fca/image.png" /></p>
</li>
<li><p>ë¼ë²¨ ë°ì´í„° ì„¤ì •
<img alt="" src="https://velog.velcdn.com/images/rimgosu/post/c9623a28-2127-4b66-8ffc-e35cb93f74a4/image.png" /></p>
</li>
<li><p>ì ìˆ˜ë¥¼ ì–´ë–¤ ê¸°ì¤€ìœ¼ë¡œ í•  ê²ƒì¸ì§€ ì²´í¬
<img alt="" src="https://velog.velcdn.com/images/rimgosu/post/18947e2b-0f68-4a3c-a7c2-2ef220ad596e/image.png" /></p>
</li>
</ul>
<h3 id="notebooks-âœï¸">NoteBooks âœï¸</h3>
<ul>
<li>ìƒˆ íŒŒì¼ ë§Œë“¤ê¸°</li>
</ul>
<p><img alt="" src="https://velog.velcdn.com/images/rimgosu/post/5effcecb-6c29-49c2-932f-f873b933c832/image.png" /></p>
<ul>
<li>í™˜ê²½ : Python 3.8 - AzureML</li>
</ul>
<h4 id="ì‘ì—…-ê³µê°„-ë§Œë“¤ê¸°">ì‘ì—… ê³µê°„ ë§Œë“¤ê¸°</h4>
<pre><code>from azureml.core import Workspace 
from azureml.core import Experiment 
ws = Workspace.from_config() 
print('Workspace name: ' + ws.name,  
      'Azure region: ' + ws.location,  
      'Subscription id: ' + ws.subscription_id,  
      'Resource group: ' + ws.resource_group, sep='\\n')

experiment = Experiment(workspace=ws, name=&quot;diabetes-experiment&quot;)</code></pre><ul>
<li>job íƒ­ì—ì„œ ì‘ì—…ê³µê°„ ë§Œë“¤ì–´ì§„ ê²ƒ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</li>
<li>ì´í›„ëŠ” ì›ë˜ í•˜ë“¯ì´ ml ëŒë¦¬ë©´ ëœë‹¤.</li>
</ul>
<h4 id="í•™ìŠµ-ì½”ë“œ">í•™ìŠµ ì½”ë“œ</h4>
<pre><code>from azureml.opendatasets import Diabetes 
from sklearn.model_selection import train_test_split 

x_df = Diabetes.get_tabular_dataset().to_pandas_dataframe().dropna() 
y_df = x_df.pop(&quot;Y&quot;) 

X_train, X_test, y_train, y_test = train_test_split(x_df, y_df, test_size=0.2, random_state=66) 

print(X_train) 
</code></pre><h4 id="best-model-ë‹¤ìš´ë¡œë“œ">best model ë‹¤ìš´ë¡œë“œ</h4>
<pre><code>from sklearn.linear_model import Ridge 
from sklearn.metrics import mean_squared_error 
from sklearn.externals import joblib 
import math 


alphas = [0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0] 


for alpha in alphas: 
    run = experiment.start_logging() 
    run.log(&quot;alpha_value&quot;, alpha) 


    model = Ridge(alpha=alpha) 
    model.fit(X=X_train, y=y_train) 
    y_pred = model.predict(X=X_test) 
    rmse = math.sqrt(mean_squared_error(y_true=y_test, y_pred=y_pred)) 
    run.log(&quot;rmse&quot;, rmse) 


    model_name = &quot;model_alpha_&quot; + str(alpha) + &quot;.pkl&quot; 
    filename = &quot;outputs/&quot; + model_name 


    joblib.dump(value=model, filename=filename) 
    run.upload_file(name=model_name, path_or_stream=filename) 
    run.complete() 
    print(f&quot;{alpha} exp completed&quot;) </code></pre><h4 id="ë°ì´í„°ì…‹-ë“±ë¡">ë°ì´í„°ì…‹ ë“±ë¡</h4>
<pre><code>import numpy as np 
from azureml.core import Dataset 


np.savetxt('features.csv', X_train, delimiter=',') 
np.savetxt('labels.csv', y_train, delimiter=',') 


datastore = ws.get_default_datastore() 
datastore.upload_files(files=['./features.csv', './labels.csv'], 
                       target_path='diabetes-experiment/', 
                       overwrite=True) 


input_dataset = Dataset.Tabular.from_delimited_files(path=[(datastore, 'diabetes-experiment/features.csv')]) 
output_dataset = Dataset.Tabular.from_delimited_files(path=[(datastore, 'diabetes-experiment/labels.csv')])</code></pre><h4 id="ëª¨ë¸-ë“±ë¡">ëª¨ë¸ ë“±ë¡</h4>
<pre><code>import sklearn 


from azureml.core import Model 
from azureml.core.resource_configuration import ResourceConfiguration 


model = Model.register(workspace=ws, 
                       model_name='diabetes-experiment-model', 
                       model_path=f&quot;./{str(best_run.get_file_names()[0])}&quot;,  
                       model_framework=Model.Framework.SCIKITLEARN,   
                       model_framework_version=sklearn.__version__,   
                       sample_input_dataset=input_dataset, 
                       sample_output_dataset=output_dataset, 
                       resource_configuration=ResourceConfiguration(cpu=1, memory_in_gb=0.5), 
                       description='Ridge regression model to predict diabetes progression.', 
                       tags={'area': 'diabetes', 'type': 'regression'}) 


print('Name:', model.name) 
print('Version:', model.version) 
</code></pre><ul>
<li><p>ë‹¤ìŒê³¼ ê°™ì´ ëª¨ë¸ì´ ì›¹ì— ëª¨ë¸ì´ ë“±ë¡ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤</p>
<p> <img alt="" src="https://velog.velcdn.com/images/rimgosu/post/9b9416bc-5964-4576-b5e2-e9cf8894cfbf/image.png" /></p>
</li>
</ul>
<h4 id="ëª¨ë¸-ë°°í¬">ëª¨ë¸ ë°°í¬</h4>
<ul>
<li>ë„ì»¤ ì»¨í…Œì´ë„ˆë¡œ ë°°í¬í•˜ì—¬ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ í•œë‹¤</li>
</ul>
<pre><code>service_name = 'diabetes-service' 


service = Model.deploy(ws, service_name, [model], overwrite=True) 
service.wait_for_deployment(show_output=True) 
</code></pre><h4 id="ë°°í¬-ì„œë¹„ìŠ¤-í…ŒìŠ¤íŠ¸">ë°°í¬ ì„œë¹„ìŠ¤ í…ŒìŠ¤íŠ¸</h4>
<pre><code>import json 

input_payload = json.dumps({ 
    'data': X_train[0:2].values.tolist(), 
    'method': 'predict' 
}) 

output = service.run(input_payload) 

print(output) </code></pre><h3 id="ì—”ë“œí¬ì¸íŠ¸ì—ì„œ-í™•ì¸">ì—”ë“œí¬ì¸íŠ¸ì—ì„œ í™•ì¸</h3>
<ul>
<li>í•™ìŠµëœ ëª¨ë¸ ì—”íŠ¸í¬ì¸íŠ¸ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</li>
</ul>
<p><img alt="" src="https://velog.velcdn.com/images/rimgosu/post/980e2239-20e8-4bd6-b0a1-cdeae4067dee/image.png" /></p>